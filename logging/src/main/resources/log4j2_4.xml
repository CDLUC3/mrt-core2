<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="INFO">
  <Appenders>
    <Console name="Text-Console" target="SYSTEM_OUT">
        <PatternLayout pattern="%d{dd-MMM-yyyy HH:mm:ss.SSS} %-5level [%t] %c{1} - %msg%n"/>
    </Console>
    <RollingFile
        name="ECS-File"
        fileName="/home/loy/tasks/logging/230515-log4j2/logstest/log4j-ecs-json.log"
        filePattern="logs/log4j-ecs-json-%d{yyyy-MM-dd}-%i.log">
      <!-- https://logging.apache.org/log4j/2.x/manual/lookups.html -->
      <EcsLayout
          serviceName="${env:SERVICE:-service}"
          serviceNodeName="${env:HOSTNAME:-${env:SERVICE:-service}}"
          eventDataset="tomcat"
          includeMarkers="true"
          stackTraceAsArray="true"
          includeOrigin="true">
         
      </EcsLayout>
      <Policies>
        <SizeBasedTriggeringPolicy size="19500KB" />
      </Policies>
      <DefaultRolloverStrategy max="10"/>
    </RollingFile>
    
    <RollingFile
        name="Json-File"
        fileName="/home/loy/tasks/logging/230515-log4j2/logstest/log4j.json"
        filePattern="logs/log4j-%d{yyyy-MM-dd}.json">
      <Policies>
        <SizeBasedTriggeringPolicy size="19500KB" />
      </Policies>
      <DefaultRolloverStrategy max="10"/>
            <JSONLayout compact="true" eventEol="true" properties="true" stacktraceAsString="true" includeTimeMillis="true">
                <KeyValuePair key="Date" value="$${date:yyyy-MM-dd HH:mm:ss}"/>
            </JSONLayout>
      <!--JSONLayout /-->
    </RollingFile>
    
    <RollingFile
        name="Text-File"
        fileName="/home/loy/tasks/logging/230515-log4j2/logstest/log4j-text.log"
        filePattern="logs/log4j-text-json-%d{yyyy-MM-dd}-%i.log">
      <Policies>
        <SizeBasedTriggeringPolicy size="19500KB" />
      </Policies>
      <DefaultRolloverStrategy max="10"/>
      <PatternLayout pattern="%d{dd-MMM-yyyy HH:mm:ss.SSS} %-5level [%t] %c{1} - %msg%n"/>
    </RollingFile>
    
  </Appenders>

  <Loggers>
    
    <Logger name="org.cdlib.mrt.action.AddState" additivity="false" level="info">
      <AppenderRef ref="rollingFile"/>
    </Logger>
    <Root level="${env:LOGLEVEL:-info}">
      <AppenderRef ref="Text-Console"/>
      <AppenderRef ref="Text-File"/>
      <AppenderRef ref="Json-File"/>
      <AppenderRef ref="ECS-File"/>
    </Root>
    
    <!--Logger name="org.cdlib.mrt.action.AddState" additivity="false" level="info">
      <AppenderRef ref="rollingFile"/>
    </Logger-->
  </Loggers>
</Configuration>